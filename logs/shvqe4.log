Train hybrid.
----------epoch 0-----------
batched average loss:  -20.308578 minimum candidate loss:  -22.422928
probability converged
strcuture parameter: 
 [[0.94000113 1.0599989 ]
 [1.0599984  0.94000167]
 [0.9400022  1.0599978 ]
 [1.059999   0.940001  ]
 [1.0599989  0.94000113]
 [1.0599973  0.94000274]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-36.982838, shape=(), dtype=float32)
----------epoch 50-----------
batched average loss:  -78.49706 minimum candidate loss:  -78.583664
probability converged
strcuture parameter: 
 [[-0.57374877  2.1121054 ]
 [ 2.106789   -0.66533405]
 [-0.5022941   2.1008742 ]
 [ 1.9927305  -0.5387111 ]
 [ 1.9612591  -0.3258195 ]
 [ 2.0440543  -0.5408437 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.596565, shape=(), dtype=float32)
----------epoch 100-----------
batched average loss:  -78.67197 minimum candidate loss:  -78.69628
probability converged
strcuture parameter: 
 [[-0.8088194   2.1500998 ]
 [ 2.1521804  -0.9886662 ]
 [-0.6432677   2.1306865 ]
 [ 2.0372267  -0.83761054]
 [ 1.9840589  -0.421873  ]
 [ 2.0957775  -0.8958168 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.69648, shape=(), dtype=float32)
----------epoch 150-----------
batched average loss:  -78.68432 minimum candidate loss:  -78.70137
probability converged
strcuture parameter: 
 [[-0.97000235  2.1636207 ]
 [ 2.1648314  -1.1748885 ]
 [-0.6868179   2.1353784 ]
 [ 2.0408823  -0.88167953]
 [ 1.9846625  -0.4260666 ]
 [ 2.108017   -1.0568153 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.7015, shape=(), dtype=float32)
----------epoch 200-----------
batched average loss:  -78.686844 minimum candidate loss:  -78.7033
probability converged
strcuture parameter: 
 [[-1.1248907   2.1744385 ]
 [ 2.1762893  -1.3841318 ]
 [-0.7319711   2.1399071 ]
 [ 2.04255    -0.90364677]
 [ 1.9846079  -0.425623  ]
 [ 2.116825   -1.1961422 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.703415, shape=(), dtype=float32)
----------epoch 250-----------
batched average loss:  -78.68508 minimum candidate loss:  -78.70581
probability converged
strcuture parameter: 
 [[-1.2717627   2.183167  ]
 [ 2.1858528  -1.6019948 ]
 [-0.7850785   2.1449606 ]
 [ 2.043339   -0.9142419 ]
 [ 1.9848486  -0.42754066]
 [ 2.1240954  -1.329178  ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.705696, shape=(), dtype=float32)
----------epoch 300-----------
batched average loss:  -78.68994 minimum candidate loss:  -78.70606
probability converged
strcuture parameter: 
 [[-1.4205017   2.1907237 ]
 [ 2.1932154  -1.8115332 ]
 [-0.842331    2.1500967 ]
 [ 2.0437818  -0.9202594 ]
 [ 1.9849186  -0.42809457]
 [ 2.130469   -1.4635267 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.7061, shape=(), dtype=float32)
----------epoch 350-----------
batched average loss:  -78.69529 minimum candidate loss:  -78.70688
probability converged
strcuture parameter: 
 [[-1.5607418   2.196845  ]
 [ 2.199146   -2.0209718 ]
 [-0.9042138   2.1553037 ]
 [ 2.0439596  -0.92268634]
 [ 1.9847335  -0.4266137 ]
 [ 2.1355722  -1.5866934 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70687, shape=(), dtype=float32)
----------epoch 400-----------
batched average loss:  -78.69623 minimum candidate loss:  -78.70716
probability converged
strcuture parameter: 
 [[-1.6970049   2.2019854 ]
 [ 2.203358   -2.2033641 ]
 [-0.96469694  2.1600676 ]
 [ 2.043962   -0.9227145 ]
 [ 1.9851346  -0.429819  ]
 [ 2.139904   -1.7054648 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70704, shape=(), dtype=float32)
----------epoch 450-----------
batched average loss:  -78.697655 minimum candidate loss:  -78.70743
probability converged
strcuture parameter: 
 [[-1.8169599   2.2059443 ]
 [ 2.2066479  -2.3752177 ]
 [-1.0289601   2.1648045 ]
 [ 2.043932   -0.92229843]
 [ 1.9849303  -0.42817253]
 [ 2.1434524  -1.8150374 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70723, shape=(), dtype=float32)
----------epoch 500-----------
batched average loss:  -78.69959 minimum candidate loss:  -78.707664
probability converged
strcuture parameter: 
 [[-1.9339336   2.2093542 ]
 [ 2.2092388  -2.5353217 ]
 [-1.0926231   2.169186  ]
 [ 2.0438957  -0.9218082 ]
 [ 1.9841735  -0.42213005]
 [ 2.146376   -1.9159864 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70763, shape=(), dtype=float32)
----------epoch 550-----------
batched average loss:  -78.699196 minimum candidate loss:  -78.70821
probability converged
strcuture parameter: 
 [[-2.0349016   2.211977  ]
 [ 2.2112277  -2.6793528 ]
 [-1.1543318   2.173158  ]
 [ 2.043832   -0.9209418 ]
 [ 1.984322   -0.42330748]
 [ 2.1488726  -2.011358  ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70763, shape=(), dtype=float32)
----------epoch 600-----------
batched average loss:  -78.69898 minimum candidate loss:  -78.70836
probability converged
strcuture parameter: 
 [[-2.1361244   2.214347  ]
 [ 2.212709   -2.8025374 ]
 [-1.2122216   2.1766515 ]
 [ 2.0438025  -0.9205296 ]
 [ 1.9844656  -0.42444986]
 [ 2.1510856  -2.1045766 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.707695, shape=(), dtype=float32)
----------epoch 650-----------
batched average loss:  -78.69748 minimum candidate loss:  -78.70882
probability converged
strcuture parameter: 
 [[-2.2207572  2.2161438]
 [ 2.214003  -2.9244165]
 [-1.2712288  2.1799996]
 [ 2.043727  -0.9194914]
 [ 1.9845577 -0.4251818]
 [ 2.1530051 -2.19331  ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70782, shape=(), dtype=float32)
----------epoch 700-----------
batched average loss:  -78.700745 minimum candidate loss:  -78.70917
probability converged
strcuture parameter: 
 [[-2.3082852   2.217845  ]
 [ 2.2150943  -3.0406597 ]
 [-1.3270429   2.1829786 ]
 [ 2.043504   -0.9164495 ]
 [ 1.9841135  -0.42164508]
 [ 2.15449    -2.2681234 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70785, shape=(), dtype=float32)
----------epoch 750-----------
batched average loss:  -78.70078 minimum candidate loss:  -78.70924
probability converged
strcuture parameter: 
 [[-2.3880274   2.219268  ]
 [ 2.216163   -3.1689992 ]
 [-1.3822274   2.1857572 ]
 [ 2.043139   -0.9114889 ]
 [ 1.9839346  -0.42022154]
 [ 2.1558998  -2.3448763 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70791, shape=(), dtype=float32)
----------epoch 800-----------
batched average loss:  -78.70177 minimum candidate loss:  -78.709465
probability converged
strcuture parameter: 
 [[-2.4668925   2.220566  ]
 [ 2.216851   -3.2617755 ]
 [-1.4354439   2.1882877 ]
 [ 2.0428298  -0.90730536]
 [ 1.9841563  -0.4219797 ]
 [ 2.157149   -2.4182894 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.707855, shape=(), dtype=float32)
----------epoch 850-----------
batched average loss:  -78.70254 minimum candidate loss:  -78.70961
probability converged
strcuture parameter: 
 [[-2.5351546   2.2216063 ]
 [ 2.2175205  -3.3613372 ]
 [-1.4894568   2.190715  ]
 [ 2.0426767  -0.905236  ]
 [ 1.984031   -0.42098543]
 [ 2.158136   -2.480592  ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70795, shape=(), dtype=float32)
----------epoch 900-----------
batched average loss:  -78.70178 minimum candidate loss:  -78.7096
probability converged
strcuture parameter: 
 [[-2.6036408   2.22258   ]
 [ 2.2180817  -3.4534278 ]
 [-1.5400461   2.1928694 ]
 [ 2.0428867  -0.90805674]
 [ 1.9839637  -0.4204493 ]
 [ 2.1590312  -2.5407357 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70793, shape=(), dtype=float32)
----------epoch 950-----------
batched average loss:  -78.70369 minimum candidate loss:  -78.70986
probability converged
strcuture parameter: 
 [[-2.664137   2.2233846]
 [ 2.2185714 -3.5415983]
 [-1.5859056  2.194722 ]
 [ 2.042629  -0.9045931]
 [ 1.9838483 -0.4195304]
 [ 2.1598144 -2.596589 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.708, shape=(), dtype=float32)
----------epoch 1000-----------
batched average loss:  -78.70355 minimum candidate loss:  -78.70979
probability converged
strcuture parameter: 
 [[-2.721448    2.2241025 ]
 [ 2.2189963  -3.625048  ]
 [-1.6312828   2.1964707 ]
 [ 2.0422792  -0.8999016 ]
 [ 1.9838674  -0.41968212]
 [ 2.1605906  -2.6552901 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70797, shape=(), dtype=float32)
----------epoch 1050-----------
batched average loss:  -78.70496 minimum candidate loss:  -78.70999
probability converged
strcuture parameter: 
 [[-2.7772017   2.2247605 ]
 [ 2.2193766  -3.7060966 ]
 [-1.6736898   2.1980317 ]
 [ 2.0420094  -0.8962971 ]
 [ 1.9840086  -0.42080185]
 [ 2.1613426  -2.7156236 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70789, shape=(), dtype=float32)
----------epoch 1100-----------
batched average loss:  -78.70484 minimum candidate loss:  -78.71004
probability converged
strcuture parameter: 
 [[-2.8285143  2.2253346]
 [ 2.21968   -3.7759066]
 [-1.7160097  2.1995232]
 [ 2.0417223 -0.8924829]
 [ 1.9842657 -0.4228408]
 [ 2.1619492 -2.7671597]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70804, shape=(), dtype=float32)
----------epoch 1150-----------
batched average loss:  -78.70487 minimum candidate loss:  -78.71028
probability converged
strcuture parameter: 
 [[-2.8805792   2.225888  ]
 [ 2.2199035  -3.8309312 ]
 [-1.7580099   2.20094   ]
 [ 2.0413167  -0.88711995]
 [ 1.984307   -0.42316714]
 [ 2.1624563  -2.8124754 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70798, shape=(), dtype=float32)
----------epoch 1200-----------
batched average loss:  -78.706085 minimum candidate loss:  -78.71037
probability converged
strcuture parameter: 
 [[-2.9276898   2.226364  ]
 [ 2.2201169  -3.8862162 ]
 [-1.7991705   2.202269  ]
 [ 2.0407336  -0.87944853]
 [ 1.9843981  -0.42389438]
 [ 2.1629732  -2.8609364 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70793, shape=(), dtype=float32)
----------epoch 1250-----------
batched average loss:  -78.704926 minimum candidate loss:  -78.71054
probability converged
strcuture parameter: 
 [[-2.9722114   2.2267928 ]
 [ 2.220299   -3.9363706 ]
 [-1.8388664   2.2034988 ]
 [ 2.0402076  -0.87259144]
 [ 1.9844087  -0.42397627]
 [ 2.163396   -2.9024327 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70806, shape=(), dtype=float32)
----------epoch 1300-----------
batched average loss:  -78.705154 minimum candidate loss:  -78.71055
probability converged
strcuture parameter: 
 [[-3.0177085   2.2272115 ]
 [ 2.2204769  -3.9878633 ]
 [-1.8764778   2.2046187 ]
 [ 2.0397613  -0.86681205]
 [ 1.9844371  -0.424201  ]
 [ 2.1638203  -2.9459238 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70794, shape=(), dtype=float32)
----------epoch 1350-----------
batched average loss:  -78.70514 minimum candidate loss:  -78.71057
probability converged
strcuture parameter: 
 [[-3.0638328   2.227617  ]
 [ 2.22062    -4.031075  ]
 [-1.9122003   2.2056427 ]
 [ 2.0391965  -0.85955846]
 [ 1.9843856  -0.42379013]
 [ 2.1642041  -2.987069  ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70798, shape=(), dtype=float32)
----------epoch 1400-----------
batched average loss:  -78.705086 minimum candidate loss:  -78.71054
probability converged
strcuture parameter: 
 [[-3.1069114   2.2279785 ]
 [ 2.2208014  -4.0886865 ]
 [-1.9480798   2.2066329 ]
 [ 2.03878    -0.8542369 ]
 [ 1.9844149  -0.42402196]
 [ 2.1645403  -3.0244482 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.708015, shape=(), dtype=float32)
----------epoch 1450-----------
batched average loss:  -78.70584 minimum candidate loss:  -78.71069
probability converged
strcuture parameter: 
 [[-3.1437855   2.2282753 ]
 [ 2.220944   -4.1364145 ]
 [-1.9805173   2.2074971 ]
 [ 2.0384192  -0.84965765]
 [ 1.9844673  -0.42443672]
 [ 2.1648772  -3.0634997 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70817, shape=(), dtype=float32)
----------epoch 1500-----------
batched average loss:  -78.70616 minimum candidate loss:  -78.710655
probability converged
strcuture parameter: 
 [[-3.179314    2.2285516 ]
 [ 2.2210884  -4.1873536 ]
 [-2.0113206   2.2082906 ]
 [ 2.0380363  -0.8448102 ]
 [ 1.9843296  -0.42333898]
 [ 2.1652062  -3.1030228 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70796, shape=(), dtype=float32)
----------epoch 1550-----------
batched average loss:  -78.70673 minimum candidate loss:  -78.71072
probability converged
strcuture parameter: 
 [[-3.2162156   2.2288284 ]
 [ 2.221198   -4.227911  ]
 [-2.0427487   2.2090762 ]
 [ 2.0374794  -0.83780575]
 [ 1.9843851  -0.4237765 ]
 [ 2.1654823  -3.1375327 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70799, shape=(), dtype=float32)
----------epoch 1600-----------
batched average loss:  -78.705734 minimum candidate loss:  -78.71084
probability converged
strcuture parameter: 
 [[-3.2478204   2.2290568 ]
 [ 2.2213132  -4.2724476 ]
 [-2.0738487   2.2098277 ]
 [ 2.0368774  -0.8302994 ]
 [ 1.9845873  -0.42538348]
 [ 2.1657474  -3.1718202 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.708015, shape=(), dtype=float32)
----------epoch 1650-----------
batched average loss:  -78.70666 minimum candidate loss:  -78.71081
probability converged
strcuture parameter: 
 [[-3.2793603   2.2292776 ]
 [ 2.2214231  -4.316787  ]
 [-2.1044793   2.2105458 ]
 [ 2.036309   -0.8232759 ]
 [ 1.9845188  -0.42483562]
 [ 2.165961   -3.2003083 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.708, shape=(), dtype=float32)
----------epoch 1700-----------
batched average loss:  -78.706314 minimum candidate loss:  -78.71066
probability converged
strcuture parameter: 
 [[-3.312234    2.2295012 ]
 [ 2.2215235  -4.359294  ]
 [-2.1347609   2.2112336 ]
 [ 2.0356321  -0.8149818 ]
 [ 1.9843113  -0.42318428]
 [ 2.1662006  -3.233396  ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70806, shape=(), dtype=float32)
----------epoch 1750-----------
batched average loss:  -78.70594 minimum candidate loss:  -78.7107
probability converged
strcuture parameter: 
 [[-3.344787   2.2297156]
 [ 2.2216058 -4.3956313]
 [-2.161318   2.2118192]
 [ 2.035049  -0.8078961]
 [ 1.9845866 -0.4253723]
 [ 2.1664317 -3.266343 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.708015, shape=(), dtype=float32)
----------epoch 1800-----------
batched average loss:  -78.70602 minimum candidate loss:  -78.71085
probability converged
strcuture parameter: 
 [[-3.3748777   2.229906  ]
 [ 2.221677   -4.428077  ]
 [-2.1885245   2.2124038 ]
 [ 2.034303   -0.79890007]
 [ 1.9845421  -0.42502287]
 [ 2.1666496  -3.2984266 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70799, shape=(), dtype=float32)
----------epoch 1850-----------
batched average loss:  -78.70592 minimum candidate loss:  -78.710945
probability converged
strcuture parameter: 
 [[-3.4031851   2.2300806 ]
 [ 2.2217503  -4.4625444 ]
 [-2.2142866   2.2129424 ]
 [ 2.0336037  -0.7905467 ]
 [ 1.9849524  -0.42829445]
 [ 2.1668177  -3.3241155 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.708145, shape=(), dtype=float32)
----------epoch 1900-----------
batched average loss:  -78.705956 minimum candidate loss:  -78.71099
probability converged
strcuture parameter: 
 [[-3.4277027   2.2302282 ]
 [ 2.2218122  -4.492136  ]
 [-2.2393034   2.2134516 ]
 [ 2.0329516  -0.78282475]
 [ 1.985217   -0.4304064 ]
 [ 2.1669772  -3.3488889 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70798, shape=(), dtype=float32)
----------epoch 1950-----------
batched average loss:  -78.70644 minimum candidate loss:  -78.711
probability converged
strcuture parameter: 
 [[-3.451944    2.2303703 ]
 [ 2.2218752  -4.5238266 ]
 [-2.2627726   2.213918  ]
 [ 2.0324495  -0.77692264]
 [ 1.9851869  -0.4301644 ]
 [ 2.1671329  -3.3737652 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70806, shape=(), dtype=float32)
----------epoch 1999-----------
batched average loss:  -78.70688 minimum candidate loss:  -78.71109
probability converged
strcuture parameter: 
 [[-3.477544    2.230516  ]
 [ 2.2219296  -4.552675  ]
 [-2.2852883   2.2143538 ]
 [ 2.0317705  -0.76899934]
 [ 1.98497    -0.42843026]
 [ 2.1672895  -3.3994377 ]]
tf.Tensor([1 0 1 0 0 0], shape=(6,), dtype=int64)
current recommendation loss:  tf.Tensor(-78.70807, shape=(), dtype=float32)
